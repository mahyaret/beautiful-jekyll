---
layout: post
title: Raspberry Pi 4 as a Cloud Server
date: '2019-09-28T17:05:00.000-04:00'
author: Mahyar
tags:
- Linux
- RaspberryPi
- debian
modified_time: '2019-12-26T20:29:25.453-05:00'
thumbnail: https://1.bp.blogspot.com/-1ghALR1EWSw/XY_c62WOmQI/AAAAAAAAA7w/tAey5M4DmikDlIEq9jr5fF0_U6d7kwDowCEwYBhgL/s72-c/JPEG%2Bimage-51AE4A518482-1.jpeg
blogger_id: tag:blogger.com,1999:blog-727803219276813688.post-5851391133646323102
blogger_orig_url: http://www.etedal.net/2019/09/raspberry-pi-4-as-cloud-server.html
---

I've bought Raspberry Pi 4 to use it as a DaaS (Desktop as a Service). I've needed a VPN server to securely connect to when I am traveling. I've needed a Cloud Server to replace Dropbox to have unlimited space. I've needed a NAS (Network-attached storage) to share files among my laptops and computers. I've also needed a Music Player Server to manage my music files and serve as a source for my amplifier. I've also needed a media player like Apple TV to play my movies, youtube etc.<br /><br />In summary Raspberry Pi as:<br />1. <a href="http://www.etedal.net/2019/09/raspberry-pi-4-as-cloud-server.html" target="_blank">Cloud server</a> (this post)<br />2. <a href="http://www.etedal.net/2019/09/raspberry-pi-4-as-vpn-server.html" target="_blank">VPN server</a><br />3. <a href="http://www.etedal.net/2019/09/raspberry-pi-4-as-nas.html" target="_blank">NAS</a><br />4. <a href="http://www.etedal.net/2019/09/raspberry-pi-4-as-hifi-music-server.html" target="_blank">Music server</a><br />5. <a href="http://www.etedal.net/2019/09/raspberry-pi-4-as-media-player.html" target="_blank">Media Player</a><br /><br /><a name='more'></a><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-1ghALR1EWSw/XY_c62WOmQI/AAAAAAAAA7w/tAey5M4DmikDlIEq9jr5fF0_U6d7kwDowCEwYBhgL/s1600/JPEG%2Bimage-51AE4A518482-1.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="987" data-original-width="1600" height="197" src="https://1.bp.blogspot.com/-1ghALR1EWSw/XY_c62WOmQI/AAAAAAAAA7w/tAey5M4DmikDlIEq9jr5fF0_U6d7kwDowCEwYBhgL/s320/JPEG%2Bimage-51AE4A518482-1.jpeg" width="320" /></a><a href="https://1.bp.blogspot.com/-y0W5wo3PztY/XY_c6re4fTI/AAAAAAAAA7w/nqE1lWjRWqMRJKxm7D4ZlJaprZXIzjthwCEwYBhgL/s1600/JPEG%2Bimage-233E2BAC51FD-1.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1600" data-original-width="1149" height="200" src="https://1.bp.blogspot.com/-y0W5wo3PztY/XY_c6re4fTI/AAAAAAAAA7w/nqE1lWjRWqMRJKxm7D4ZlJaprZXIzjthwCEwYBhgL/s200/JPEG%2Bimage-233E2BAC51FD-1.jpeg" width="143" /></a></div><br /><br />To be able to do all of the above, I think it is better to keep the original Raspbian distribution.<br /><br />I have used Nextcloud:<br />I have used an external hard drive to the Raspberry Pi (rp). Since there is a chance that when you restart your rp it automatically mount external hard drive to different place it is a good idea to configure fstab to make sure that it always mounted on the right place. I also set static ip for rp (192.168.0.101)<br /><br />Installing Nextcloud:<br />&nbsp; &nbsp; sudo apt install snapd<br />&nbsp; &nbsp; sudo snap install nextcloud<br /><br />Setting up the external hard drive:<br />&nbsp; &nbsp; sudo mkdir /media/pi/cloud<br /><br />select UUID of your external hard drive: &nbsp; <br />&nbsp; &nbsp; sudo blkid<br />&nbsp; &nbsp; sudo emacs /etc/fstab<br /><br />Use tab for each column when you add the following:<br /><div style="font-family: Menlo; font-size: 14px; font-stretch: normal; line-height: normal;"><span style="color: #d17125; font-variant-ligatures: no-common-ligatures;">UUID=YOURS</span><span style="font-variant-ligatures: no-common-ligatures;">&nbsp;/media/pi/cloud &nbsp; &nbsp; &nbsp; auto&nbsp; &nbsp; nosuid,nodev,nofail &nbsp; &nbsp; 0 &nbsp; &nbsp; &nbsp; 0</span></div><br />Now reboot to see it mounts the external drive properly at the right place.<br /><br />Now edit the configuration file:<br /><div style="font-stretch: normal; line-height: normal;"><span style="font-variant-ligatures: no-common-ligatures;"><span style="font-family: inherit;">sudo emacs /var/snap/nextcloud/current/nextcloud/config/autoconfig.php</span></span></div><br />change the data directory as:<br />'directory' =&gt; '/media/pi/cloud'<br /><br />Start nextcloud: <br />sudo snap restart nextcloud.php-fpm<br /><br /><div style="box-sizing: border-box; caret-color: rgb(36, 41, 46); color: #24292e; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-size: 16px; margin-bottom: 16px;">To install a Let's Encrypt SSL certificate, type:</div><div style="box-sizing: border-box; caret-color: rgb(36, 41, 46); color: #24292e; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-size: 16px; margin-bottom: 16px;">cd /snap/bin <br />sudo ./nextcloud.enable-https lets-encrypt <br /><br />or<br /><br />&nbsp;sudo ./nextcloud.enable-https self-signed</div><div style="box-sizing: border-box; caret-color: rgb(36, 41, 46); color: #24292e; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-size: 16px; margin-bottom: 16px;">If you use public dynamic dns services like noip remember to add it to config:</div><div style="box-sizing: border-box; caret-color: rgb(36, 41, 46); color: #24292e; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-size: 16px; margin-bottom: 16px;">sudo emacs /var/snap/nextcloud/current/nextcloud/config/config.php</div><div style="color: #b23080; font-family: Menlo; font-size: 14px; font-stretch: normal; line-height: normal;"><span style="font-variant-ligatures: no-common-ligatures;">'trusted_domains'</span><span style="color: black; font-variant-ligatures: no-common-ligatures;"> =&gt;</span></div><div style="font-family: Menlo; font-size: 14px; font-stretch: normal; line-height: normal;"><span style="font-variant-ligatures: no-common-ligatures;">&nbsp; array (</span></div><div style="color: #b23080; font-family: Menlo; font-size: 14px; font-stretch: normal; line-height: normal;"><span style="color: black; font-variant-ligatures: no-common-ligatures;">&nbsp; &nbsp; </span><span style="color: #d17125; font-variant-ligatures: no-common-ligatures;">0</span><span style="color: black; font-variant-ligatures: no-common-ligatures;"> =&gt; </span><span style="font-variant-ligatures: no-common-ligatures;">'192.168.0.101'</span><span style="color: black; font-variant-ligatures: no-common-ligatures;">,</span></div><div style="color: #b23080; font-family: Menlo; font-size: 14px; font-stretch: normal; line-height: normal;"><span style="color: black; font-variant-ligatures: no-common-ligatures;">&nbsp; &nbsp; </span><span style="color: #d17125; font-variant-ligatures: no-common-ligatures;">1</span><span style="color: black; font-variant-ligatures: no-common-ligatures;"> =&gt; </span><span style="font-variant-ligatures: no-common-ligatures;">'192.168.0.*'</span><span style="color: black; font-variant-ligatures: no-common-ligatures;">,</span></div><div style="color: #b23080; font-family: Menlo; font-size: 14px; font-stretch: normal; line-height: normal;"><span style="color: black; font-variant-ligatures: no-common-ligatures;">&nbsp; &nbsp; </span><span style="color: #d17125; font-variant-ligatures: no-common-ligatures;">2</span><span style="color: black; font-variant-ligatures: no-common-ligatures;"> =&gt; </span><span style="font-variant-ligatures: no-common-ligatures;">'YOURS.ddns.net'</span><span style="color: black; font-variant-ligatures: no-common-ligatures;">,</span></div><div style="box-sizing: border-box; caret-color: rgb(36, 41, 46); color: #24292e; font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-size: 16px; margin-bottom: 16px;"></div><div style="font-family: Menlo; font-size: 14px; font-stretch: normal; line-height: normal;"><span style="font-variant-ligatures: no-common-ligatures;">&nbsp; ),</span></div><br />check the directory file in the config if it is set to the right place<br /><br /><div style="color: #b23080; font-family: Menlo; font-size: 14px; font-stretch: normal; line-height: normal;"><span style="font-variant-ligatures: no-common-ligatures;">'datadirectory'</span><span style="color: black; font-variant-ligatures: no-common-ligatures;"> =&gt; </span><span style="font-variant-ligatures: no-common-ligatures;">'/media/pi/cloud'</span><span style="color: black; font-variant-ligatures: no-common-ligatures;">,</span></div><div style="color: #b23080; font-family: Menlo; font-size: 14px; font-stretch: normal; line-height: normal;"><span style="color: black; font-variant-ligatures: no-common-ligatures;"><br /></span></div><br /><br />