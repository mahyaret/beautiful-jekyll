---
layout: post
title: How to use an sql query result
date: '2010-05-01T13:26:00.000-04:00'
author: Mahyar
tags:
- Database
- Csharp
modified_time: '2010-05-01T13:29:15.428-04:00'
blogger_id: tag:blogger.com,1999:blog-727803219276813688.post-8303705489731022240
blogger_orig_url: http://www.etedal.net/2010/05/how-to-use-sql-query-result.html
---

<span style="font-family:trebuchet MS;"><span style="color: rgb(0, 0, 255);font-size:85%;" >using</span><span style="font-size:85%;"> System;<br />      </span><span style="color: rgb(0, 0, 255);font-size:85%;" >using</span><span style="font-size:85%;">  System.Data;<br />      </span><span style="color: rgb(0, 0, 255);font-size:85%;" >using</span><span style="font-size:85%;">  System.Data.SqlClient;<br />      <br />      </span><span style="color: rgb(128, 128, 128);font-size:85%;" >///</span><span style="color: rgb(0, 128, 0);font-size:85%;" > </span>        <span style="color: rgb(128, 128, 128);font-size:85%;" ><summary><br />       ///</summary></span><span style="color: rgb(0, 128, 0);font-size:85%;" > Demonstrates how to  work with          SqlConnection objects<br />      </span><span style="color: rgb(128, 128, 128);font-size:85%;" >///</span><span style="color: rgb(0, 128, 0);font-size:85%;" > </span>        <span style="color: rgb(128, 128, 128);font-size:85%;" ><br />      </span><span style="color: rgb(0, 0, 255);font-size:85%;" >class</span><span style="font-size:85%;">  SqlConnectionDemo<br />       {<br />      </span><span style="color: rgb(0, 0, 255);font-size:85%;" >    static</span><span style="font-size:85%;">        </span><span style="color: rgb(0, 0, 255);font-size:85%;" >void</span><span style="font-size:85%;">  Main()<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>{<br />      </span><span style="color: rgb(0, 128, 0);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>// 1. Instantiate the connection<br />      </span><span style="font-size:85%;"><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>            </span>SqlConnection conn = </span><span style="color: rgb(0, 0, 255);font-size:85%;" >new</span><span style="font-size:85%;">         SqlConnection(<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span></span><span style="font-size:85%;">"Data  Source=(local);Initial          Catalog=Northwind;Integrated Security=SSPI");<br />      <br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>             </span>SqlDataReader rdr = </span><span style="color: rgb(0, 0, 255);font-size:85%;" >null</span><span style="font-size:85%;">;<br />      </span><span style="color: rgb(0, 0, 255);font-size:85%;" >        <br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>             </span>try<br />      </span><span style="font-size:85%;"><span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>{<br />      </span><span style="color: rgb(0, 128, 0);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >              </span></span></span>// 2. Open the connection<br />      </span><span style="font-size:85%;"><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >              </span></span>conn.Open();<br />      </span><span style="color: rgb(0, 128, 0);font-size:85%;" >        <br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>// 3. Pass the connection to a command object<br />      </span><span style="font-size:85%;"><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >              </span></span>SqlCommand cmd = </span><span style="color: rgb(0, 0, 255);font-size:85%;" >new</span><span style="font-size:85%;">         SqlCommand("select * from Customers", conn);<br />      </span><span style="color: rgb(0, 128, 0);font-size:85%;" >        <br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>//<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>// 4. Use the connection<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>//<br />      <br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>// get query results<br />      </span><span style="font-size:85%;"><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >              </span></span>rdr = cmd.ExecuteReader();<br />      </span><span style="color: rgb(0, 128, 0);font-size:85%;" >        <br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>// print the CustomerID of each record<br />      </span><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >    </span><span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>while</span><span style="font-size:85%;"> (rdr.Read())<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >              </span></span></span>{<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >               </span></span></span></span>Console.WriteLine(rdr[0]);<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>}<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>             </span>}<br />      </span><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >               </span>    </span>finally<br />      </span><span style="font-size:85%;"><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>            </span>{<br />      </span><span style="color: rgb(0, 128, 0);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >               </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>// close the reader<br />      </span><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >               </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>if</span><span style="font-size:85%;"> (rdr != </span><span style="color: rgb(0, 0, 255);font-size:85%;" >         null</span><span style="font-size:85%;">)<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>{<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >              </span></span></span>rdr.Close();<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>}<br />      </span><span style="color: rgb(0, 128, 0);font-size:85%;" >        <br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>// 5. Close the connection<br />      </span><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >               </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>if</span><span style="font-size:85%;"> (conn != </span><span style="color: rgb(0, 0, 255);font-size:85%;" >         null</span><span style="font-size:85%;">)<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>{<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >    <span style="color: rgb(0, 0, 255);font-size:85%;" >              </span></span></span>conn.Close();<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>    <span style="color: rgb(0, 0, 255);font-size:85%;" >             </span></span>}<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" ><span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>             </span>}<br />       <span style="color: rgb(0, 0, 255);font-size:85%;" >    </span>}<br />       }</span></span>